# values-dev.yaml

# Отключаем ZooKeeper (по умолчанию и так выключен в Kafka 4.0+)
zookeeper:
  enabled: false

# KRaft-контроллеры (брокеры + контроллеры в одном)
controller:
  replicaCount: 2

  persistence:
    enabled: true
    size: 8Gi
    storageClass: "standard"

  # Отключаем SASL/SCRAM — используем PLAINTEXT
  auth:
    clientProtocol: plaintext
    interBrokerProtocol: plaintext
    controllerProtocol: plaintext
    enabled: false  # ← отключает генерацию SCRAM-пользователей

  # Настройки слушателей
  listeners:
    client:
      protocol: PLAINTEXT
      port: 9092
    controller:
      protocol: PLAINTEXT
      port: 9093
    interbroker:
      protocol: PLAINTEXT
      port: 9094

  # Конфигурация Kafka сервера
  config:
    auto.create.topics.enable: "true"
    delete.topic.enable: "true"
    offsets.topic.replication.factor: "2"
    transaction.state.log.replication.factor: "2"
    transaction.state.log.min.isr: "1"
    log.retention.hours: "168"
    num.partitions: "3"
    default.replication.factor: "2"
    # KRaft обязателен
    process.roles: "broker,controller"
    node.id: ""  # генерируется автоматически
    controller.listener.names: "CONTROLLER"

  service:
    type: ClusterIP

  volumePermissions:
    enabled: true

# Метрики (опционально)
metrics:
  kafka:
    enabled: true