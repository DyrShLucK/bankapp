apiVersion: v1
kind: Pod
metadata:
  name: "bankapp-dev-account-service-test-connection"
  annotations:
    "helm.sh/hook": test
spec:
  containers:
    - name: account-service-test
      image: busybox
      command: ['sh', '-c']
      args:
        - |
          wget -O- --server-response http://bankapp-dev-account-service:8081/ 2>&1 | tee /tmp/response
          # Проверяем, что получили 200, 204 или 404
          if grep -q "HTTP/1.1 200\|HTTP/1.1 204\|HTTP/1.1 404" /tmp/response; then
            echo "Test passed: received expected HTTP code"
            exit 0
          else
            echo "Test failed: received unexpected HTTP code"
            exit 1
          fi
  restartPolicy: Never